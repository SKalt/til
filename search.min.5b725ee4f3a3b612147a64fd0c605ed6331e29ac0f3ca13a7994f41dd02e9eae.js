import Fuse from"https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.basic.esm.min.js";const options={shouldSort:!0,includeMatches:!0,threshold:.1,keys:["tags","content"]};fetch(window.articleIndexUrl).catch(console.error).then(e=>e.json()).then(e=>{const o=new Fuse(e,options),n=document.getElementById("search-input"),t=document.getElementById("results"),s=document.createElement("div");n.addEventListener("input",e=>{let i=o.search(n.value);console.log(i),Array.from(t.children).forEach(e=>t.removeChild(e)),i.forEach(({item:e,matches:n})=>{const i=([t,n])=>{const s=e.content.slice(Math.max(0,t-20),t),o=e.content.slice(t,n+1),i=e.content.slice(n+1,Math.min(e.content.length+1,n+20));return`<div class="search-match-context">${s}<b>${o}</b>${i}</div>`},a=e.permalink.split("til/")[1],r=n.filter(e=>e.key=="content").map(e=>e.indices.map(i).join("")).join(""),o=n.filter(e=>e.key=="tags").map(e=>{const{value:t,indices:o}=e,[n,s]=o[0];return`&nbsp;<span class="tag">${t.slice(0,n)}<b>${t.slice(n,s+1)}</b>${t.slice(s+1)}</span>`}).join("");console.log({tagMatches:o}),s.innerHTML=`<a style="color: var(--font); text-decoration: none" href="${e.permalink}">
      <div><code>${a}</code>${o}</div>
        <div>${r}</div>
      </a>`,t.appendChild(s.children[0])})})})