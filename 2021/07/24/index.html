<!doctype html><html><head><meta charset=utf-8><title>Today I Learned</title><link rel=stylesheet href=https://skalt.github.io/til/critical.min.594b5b7a363d42cef2053010611ce4d2364196b08b295f8bf7199f9406b595e4.css></head><body><header><h1><a href=https://skalt.github.io/til/>Today I Learned</a></h1><nav><a href=https://skalt.github.io/til/tags>tags</a>
<a href=https://skalt.github.io/til/search>search</a>
<a href=https://github.com/skalt/til><img alt=repo title=repo src=https://skalt.github.io/til/icon_gh.512c0dbb601adf88d85cdd317f632f04c74f76183e9dd30c331272d46a59aa13.svg></a>
<a href><img alt=rss title=rss src=https://skalt.github.io/til/icon_rss.2712ea2c7402d63d00f842fbc9dc64b6461012d726f7385aae61b031d1614ebd.svg></a></a></nav></header><main><h1><a href=https://skalt.github.io/til/2021>2021</a>/<span>07</span>/24</h1><div><a href=https://skalt.github.io/til/tags/js>js</a>
<a href=https://skalt.github.io/til/tags/javascript>javascript</a>
<a href=https://skalt.github.io/til/tags/typescript>typescript</a>
<a href=https://skalt.github.io/til/tags/fetch>fetch</a>
<a href=https://skalt.github.io/til/tags/shell>shell</a></div><p><a href=https://web.dev/fetch-upload-streaming/#previously-on-the-exciting-adventures-of-fetch-streams>How to stream large responses using the Javascript <code>Fetch</code> API:</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>getReader</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>true</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>done</span> } <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>read</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>done</span>) <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Received&#39;</span>, <span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Response fully received&#39;</span>);
</span></span></code></pre></div><p>Also: <a href=https://linuxhandbook.com/login-shell/>the circumstances under which ~/.*profile files are run: only if you log in.</a></p></main><footer><span>Â© 2022-2022 CC BY-NC-SA 4.0</span></footer></body></html>