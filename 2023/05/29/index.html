<!doctype html><html><head><meta charset=utf-8><title>Today I Learned</title>
<link rel=stylesheet href=https://skalt.github.io/til/critical.min.31ad46bcf2679dac23a81f48b7ead9b8f05c1c77fe86709a56fcce62f2ee6107.css><style>@import "https://skalt.github.io/til/syntax-light.min.cf596d35510d6f4d08d1eec88d3d2374b3ba785ef2c68eb605930d31b93576a5.css";@media(prefers-color-scheme:dark){@import "https://skalt.github.io/til/syntax-dark.min.aa68da46c4e748d1db4b8300bf7e282aaa0befd767ada0dcc34734e9ac4e0d51.css"}</style><script src=https://skalt.github.io/til/copy_on_click.8cfac4031a49e9c8b3e73dddf794e25074203ced17014a6810fda1ce8842b42d.js integrity="sha256-jPrEAxpJ6ciz5z3d95TiUHQgPO0XAUpoEP2hzohCtC0=" defer></script></head><body><header><h1><a href=https://skalt.github.io/til/>Today I Learned</a></h1><nav><a href=https://skalt.github.io/til/tags>tags</a>
<a href=https://skalt.github.io/til/search>search</a>
<a href=https://github.com/skalt/til><img alt=repo title=repo src=https://skalt.github.io/til/icon_gh.512c0dbb601adf88d85cdd317f632f04c74f76183e9dd30c331272d46a59aa13.svg></a></nav></header><main><h1><a href=https://skalt.github.io/til/2023>2023</a>/<span>05</span>/29</h1><div><a href=https://skalt.github.io/til/tags/haskell>haskell</a></div><p>During some research on build systems, I began re-reading Build Systems a la Carte (<a href=https://github.com/snowleopard/build>repo</a>, <a href=https://www.cambridge.org/core/services/aop-cambridge-core/content/view/097CE52C750E69BD16B78C318754C7A4/S0956796820000088a.pdf/build-systems-a-la-carte-theory-and-practice.pdf>paper</a>).
I found the Haskell even more confusing than I remembered, so I set out to translate the Haskell types to Typescript, Rust, and other type systems I know.
When I got into the translation, I realized I only know enough to get the <em>vibe</em> of what Haskell code&rsquo;s saying :/.</p><p>The following are my notes on the 2021 open-source update to <em><a href=https://learnyouahaskell.github.io/types-and-typeclasses.html>Learn You A Haskell for Great Good</a></em>.</p><h2 id=starting-out>Starting out</h2><p><a href=https://learnyouahaskell.github.io/starting-out.html#an-intro-to-lists>https://learnyouahaskell.github.io/starting-out.html#an-intro-to-lists</a></p><p>What is the underlying datatype of a list? A linked list? Growable <code>Vec&lt;T></code>?</p><blockquote><p><code>++</code>
<code>:</code></p></blockquote><p>I already need a language server for figuring out operator definitions.</p><p>List comprehension syntax:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=p>[</span> <span class=n>output</span> <span class=n>var</span> <span class=o>|</span> <span class=n>var</span> <span class=ow>&lt;-</span> <span class=n>inputSet</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1>-- ^^^^^^^^^ </span>
</span></span><span class=line><span class=cl><span class=c1>-- the output function</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>-- also valid:</span>
</span></span><span class=line><span class=cl><span class=p>[</span> <span class=n>output</span> <span class=n>var</span> <span class=o>|</span> <span class=n>var</span> <span class=ow>&lt;-</span> <span class=n>inputSet</span><span class=p>,</span> <span class=n>filterFn</span> <span class=n>var</span><span class=p>,</span> <span class=n>otherFilterFn</span> <span class=n>var</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1>-- also valid:</span>
</span></span><span class=line><span class=cl><span class=nf>triangles</span> <span class=ow>=</span> <span class=p>[</span> <span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>,</span><span class=n>c</span><span class=p>)</span> <span class=o>|</span> <span class=n>c</span> <span class=ow>&lt;-</span> <span class=p>[</span><span class=mi>1</span><span class=o>..</span><span class=mi>10</span><span class=p>],</span> <span class=n>b</span> <span class=ow>&lt;-</span> <span class=p>[</span><span class=mi>1</span><span class=o>..</span><span class=mi>10</span><span class=p>],</span> <span class=n>a</span> <span class=ow>&lt;-</span> <span class=p>[</span><span class=mi>1</span><span class=o>..</span><span class=mi>10</span><span class=p>]</span> <span class=p>]</span>
</span></span></code></pre></div><p>Lists are homogenous, tuples can be heterogenous.</p><p>Range syntax seems to be the same as Rust.</p><h2 id=types--typeclasseshttpslearnyouahaskellgithubiotypes-and-typeclasseshtml><a href=https://learnyouahaskell.github.io/types-and-typeclasses.html>Types & Typeclasses</a></h2><blockquote><p>The <code>[Char]</code> type is synonymous with <code>String</code></p></blockquote><blockquote><pre tabindex=0><code>-- function type declaration
addThree :: Int -&gt; Int -&gt; Int -&gt; Int  
addThree x y z = x + y + z
-- fn definition
</code></pre></blockquote><p>Looks like functions are <a href=https://en.wikipedia.org/wiki/Currying>curried</a>.</p><p>Fun fact: Haskell was named after <a href=https://en.wikipedia.org/wiki/Haskell_Curry>Haskell Curry</a></p><blockquote><p>A typeclass is a sort of interface that defines some behavior. If a type is a part of a typeclass, that means that it supports and implements the behavior the typeclass describes.</p></blockquote><p>So like a typescript <code>interface</code> or a rust <code>trait</code></p><blockquote><p>Everything before the => symbol is called a class constraint.</p></blockquote><h2 id=syntax-in-functionshttpslearnyouahaskellgithubiosyntax-in-functionshtml><a href=https://learnyouahaskell.github.io/syntax-in-functions.html>Syntax in Functions</a></h2><p>Looks like hitting an un-handled branch of pattern matching throws an exception.
There are probably lints for such omissions.</p><p>Looks like <code>_</code> is used as the ignored variable.</p><blockquote><p>Guards are indicated by pipes that follow a function&rsquo;s name and its parameters. Usually, they&rsquo;re indented a bit to the right and lined up. A guard is basically a boolean expression. If it evaluates to True, then the corresponding function body is used. If it evaluates to False, checking drops through to the next guard and so on.</p></blockquote><p>Neat!</p><blockquote><p><code>where</code> bindings are a syntactic construct that let you bind to variables at the end of a function and the whole function can see them, including all the guards. <code>let</code> bindings let you bind to variables anywhere and are expressions themselves, but are very local, so they don&rsquo;t span across guards.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=nf>x</span> <span class=ow>=</span> <span class=kr>let</span> <span class=n>a</span> <span class=ow>=</span> <span class=mi>1</span> <span class=kr>in</span> <span class=n>a</span> <span class=o>+</span> <span class=mi>1</span> <span class=c1>-- x == 2</span>
</span></span></code></pre></div><blockquote><p>If we want to bind to several variables inline [&mldr;] we can separate them with semicolons.</p><pre tabindex=0><code>(let a = 100; b = 200; c = 300 in a*b*c, let foo=&#34;Hey &#34;; bar = &#34;there!&#34; in foo ++ bar)  
-- (6000000,&#34;Hey there!&#34;)
</code></pre></blockquote><p><code>case</code> expressions seem to be directly analogous to rust&rsquo;s <code>match</code> expressions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>case</span> <span class=n>expression</span> <span class=kr>of</span> <span class=n>pattern</span> <span class=ow>-&gt;</span> <span class=n>result</span>  
</span></span><span class=line><span class=cl>                   <span class=n>pattern</span> <span class=ow>-&gt;</span> <span class=n>result</span>  
</span></span><span class=line><span class=cl>                   <span class=n>pattern</span> <span class=ow>-&gt;</span> <span class=n>result</span>  
</span></span><span class=line><span class=cl>                   <span class=o>...</span>
</span></span></code></pre></div><h2 id=higher-order-functionshttpslearnyouahaskellgithubiohigher-order-functionshtml><a href=https://learnyouahaskell.github.io/higher-order-functions.html>Higher order functions</a></h2><blockquote><p>Infix functions can also be partially applied by using sections. To section an infix function, simply surround it with parentheses and only supply a parameter on one side. That creates a function that takes one parameter and then applies it to the side that&rsquo;s missing an operand.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=nf>divideByTen</span> <span class=ow>::</span> <span class=p>(</span><span class=kt>Floating</span> <span class=n>a</span><span class=p>)</span> <span class=ow>=&gt;</span> <span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>a</span>  
</span></span><span class=line><span class=cl><span class=nf>divideByTen</span> <span class=ow>=</span> <span class=p>(</span><span class=o>/</span><span class=mi>10</span><span class=p>)</span>  
</span></span></code></pre></div></blockquote><p>&ldquo;lambdas&rdquo; = anonymous fns; written like</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=c1>--  v starting \</span>
</span></span><span class=line><span class=cl>   <span class=p>(</span><span class=nf>\</span><span class=n>arg</span> <span class=ow>-&gt;</span> <span class=n>result</span> <span class=n>expr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>-- ^                   ^ always parenthesized</span>
</span></span></code></pre></div><blockquote><p>[Haskell does] function composition with the . function, which is defined like so:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl>   <span class=p>(</span><span class=o>.</span><span class=p>)</span> <span class=ow>::</span> <span class=p>(</span><span class=n>b</span> <span class=ow>-&gt;</span> <span class=n>c</span><span class=p>)</span> <span class=ow>-&gt;</span> <span class=p>(</span><span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>b</span><span class=p>)</span> <span class=ow>-&gt;</span> <span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>c</span>  
</span></span><span class=line><span class=cl>   <span class=n>f</span> <span class=o>.</span> <span class=n>g</span> <span class=ow>=</span> <span class=nf>\</span><span class=n>x</span> <span class=ow>-&gt;</span> <span class=n>f</span> <span class=p>(</span><span class=n>g</span> <span class=n>x</span><span class=p>)</span>
</span></span></code></pre></div></blockquote><blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=p>(</span><span class=o>$</span><span class=p>)</span> <span class=ow>::</span> <span class=p>(</span><span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>b</span><span class=p>)</span> <span class=ow>-&gt;</span> <span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>b</span>  
</span></span><span class=line><span class=cl><span class=nf>f</span> <span class=o>$</span> <span class=n>x</span> <span class=ow>=</span> <span class=n>f</span> <span class=n>x</span>
</span></span></code></pre></div><p>Whereas normal function application (putting a space between two things) has a really high precedence, the <code>$</code> function has the lowest precedence. Function application with a space is left-associative (so <code>f a b c</code> is the same as <code>((f a) b) c))</code>, function application with <code>$</code> is right-associative. &mldr; Most of the time, <code>$</code>&rsquo;s a convenience function so that we don&rsquo;t have to write so many parentheses.
When a <code>$</code> is encountered, the expression on its right is applied as the parameter to the function on its left. How about <code>sqrt 3 + 4 + 9</code>? This adds together 9, 4 and the square root of 3. If we want to get the square root of 3 + 4 + 9, we&rsquo;d have to write <code>sqrt (3 + 4 + 9)</code> or if we use <code>$</code> we can write it as <code>sqrt $ 3 + 4 + 9</code> because <code>$</code> has the lowest precedence of any operator. That&rsquo;s why you can imagine a <code>$</code> being sort of the equivalent of writing an opening parenthesis and then writing a closing one on the far right side of the expression.</p></blockquote><p>^ this clears up a <em>lot</em>!</p><h2 id=moduleshttpslearnyouahaskellgithubiomoduleshtml><a href=https://learnyouahaskell.github.io/modules.html>Modules</a></h2><p>Note: the <code>Prelude</code> module is imported by default.
Note: module paths are separated by <code>.</code>s, e.g. <code>Data.List</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>import</span> <span class=nn>Data.List</span> <span class=p>(</span><span class=nf>nub</span><span class=p>,</span> <span class=nf>sort</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nn>Data.List</span> <span class=k>hiding</span> <span class=p>(</span><span class=nf>nub</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=k>qualified</span> <span class=nn>Data.Map</span>
</span></span><span class=line><span class=cl><span class=c1>-- if we want to reference Data.Map&#39;s filter function, we have to</span>
</span></span><span class=line><span class=cl><span class=c1>-- do `Data.Map.filter`</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=k>qualified</span> <span class=nn>Data.Map</span> <span class=k>as</span> <span class=n>M</span> <span class=c1>-- `M.filter`</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>module</span> <span class=nn>ModName</span> <span class=p>(</span> <span class=c1>-- must be same name as file.hs? MUST be capitalized</span>
</span></span><span class=line><span class=cl>  <span class=nf>exported</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span> <span class=nf>fn</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span> <span class=nf>names</span>
</span></span><span class=line><span class=cl>  <span class=p>,</span> <span class=kt>Thing</span><span class=p>(</span><span class=o>..</span><span class=p>)</span> <span class=c1>-- all the value constructors for Thing</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=kr>where</span>
</span></span></code></pre></div><p>Multi-module groups are directories of <code>ModName.hs</code> files, imported like <code>import GroupName.ModName</code>.</p><h2 id=making-our-own-types-and-typeclasses>making our own types and typeclasses</h2><blockquote><p>if we add deriving (Show) at the end of a data declaration, Haskell automagically makes that type part of the Show typeclass.</p></blockquote><blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>data</span> <span class=kt>Person</span> <span class=ow>=</span> <span class=kt>Person</span> <span class=p>{</span> <span class=n>firstName</span> <span class=ow>::</span> <span class=kt>String</span>  
</span></span><span class=line><span class=cl>                     <span class=p>,</span> <span class=n>lastName</span> <span class=ow>::</span> <span class=kt>String</span>  
</span></span><span class=line><span class=cl>                     <span class=p>,</span> <span class=n>age</span> <span class=ow>::</span> <span class=kt>Int</span>  
</span></span><span class=line><span class=cl>                     <span class=p>,</span> <span class=n>height</span> <span class=ow>::</span> <span class=kt>Float</span>  
</span></span><span class=line><span class=cl>                     <span class=p>,</span> <span class=n>phoneNumber</span> <span class=ow>::</span> <span class=kt>String</span>  
</span></span><span class=line><span class=cl>                     <span class=p>,</span> <span class=n>flavor</span> <span class=ow>::</span> <span class=kt>String</span>  
</span></span><span class=line><span class=cl>                     <span class=p>}</span> <span class=kr>deriving</span> <span class=p>(</span><span class=kt>Show</span><span class=p>)</span>
</span></span></code></pre></div></blockquote><blockquote><p>type constructors can take types as parameters to produce new types</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>data</span> <span class=kt>Maybe</span> <span class=n>a</span> <span class=ow>=</span> <span class=kt>Nothing</span> <span class=o>|</span> <span class=kt>Just</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=c1>--    type ^ parameter</span>
</span></span></code></pre></div></blockquote><blockquote><p>A type can be made an instance of a typeclass if it supports that behavior. Example: the <code>Int</code> type is an instance of the <code>Eq</code> typeclass because the <code>Eq</code> typeclass defines behavior for stuff that can be equated.</p><p>&ndash; <a href=https://learnyouahaskell.github.io/making-our-own-types-and-typeclasses.html#derived-instances>derived instances</a></p></blockquote><blockquote><p>When I talk about <strong>concrete types</strong> I mean like fully applied types</p></blockquote><p>So concrete types don&rsquo;t have any free type parameters, but type constructors may have further free type parameters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>class</span> <span class=kt>Eq</span> <span class=n>equatable</span> <span class=kr>where</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></div><p>^ this is how to define a typeclass, noting that <code>equatable</code> is a type parameter.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>class</span> <span class=p>(</span><span class=kt>Eq</span> <span class=n>a</span><span class=p>)</span> <span class=ow>=&gt;</span> <span class=kt>Num</span> <span class=n>a</span> <span class=kr>where</span>  
</span></span><span class=line><span class=cl>    <span class=o>...</span>    
</span></span><span class=line><span class=cl><span class=kr>instance</span> <span class=kt>Eq</span> <span class=p>(</span><span class=kt>Maybe</span> <span class=n>m</span><span class=p>)</span> <span class=kr>where</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></div><p>^ defining instances / implementations of a typeclass.</p><blockquote><p>the <code>Functor</code> typeclass, which is basically for things that can be mapped over. &mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-hs data-lang=hs><span class=line><span class=cl><span class=kr>class</span> <span class=kt>Functor</span> <span class=n>f</span> <span class=kr>where</span>  
</span></span><span class=line><span class=cl>  <span class=n>fmap</span> <span class=ow>::</span> <span class=p>(</span><span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>b</span><span class=p>)</span> <span class=ow>-&gt;</span> <span class=n>f</span> <span class=n>a</span> <span class=ow>-&gt;</span> <span class=n>f</span> <span class=n>b</span>
</span></span></code></pre></div><p>the f is not a concrete type (a type that a value can hold, like Int, Bool or Maybe String), but a type constructor that takes one type parameter.</p></blockquote><hr><p>This is enough for me to read further, so I&rsquo;m stopping for now.</p></main><footer><span>© 2022-2022 CC BY-NC-SA 4.0</span></footer></body></html>