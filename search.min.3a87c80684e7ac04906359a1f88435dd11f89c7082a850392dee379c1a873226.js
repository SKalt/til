import Fuse from'https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.basic.esm.min.js';const options={shouldSort:!0,includeMatches:!0,threshold:.1,keys:["tags","content"]};fetch(window.articleIndexUrl).catch(console.error).then(e=>e.json()).then(s=>{const o=new Fuse(s,options),t=document.getElementById("search-input"),e=document.getElementById('results'),n=document.createElement('div');t.addEventListener("input",i=>{let s=o.search(t.value);console.log(s),Array.from(e.children).forEach(t=>e.removeChild(t)),s.forEach(({item:t,matches:s})=>{const i=([e,n])=>{const s=t.content.slice(Math.max(0,e-20),e),o=t.content.slice(e,n+1),i=t.content.slice(n+1,Math.min(t.content.length+1,n+20));return`<div class="search-match-context">${s}<b>${o}</b>${i}</div>`},a=t.permalink.split("til/")[1],r=s.filter(e=>e.key=="content").map(e=>e.indices.map(i).join('')).join(''),o=s.filter(e=>e.key=="tags").map(s=>{const{value:e,indices:o}=s,[t,n]=o[0];return`&nbsp;<span class="tag">${e.slice(0,t)}<b>${e.slice(t,n+1)}</b>${e.slice(n+1)}</span>`}).join("");console.log({tagMatches:o}),n.innerHTML=`<a style="color: var(--font); text-decoration: none" href="${t.permalink}">
      <div><code>${a}</code>${o}</div>
        <div>${r}</div>
      </a>`,e.appendChild(n.children[0])})})})